<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal Arcano | Zodíaco Chinês</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Cormorant+Garamond:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root { --gold: #d4af37; --bg-dark: #050505; --red: #8a1c1c; }
        
        body { margin: 0; font-family: 'Cormorant Garamond', serif; background: var(--bg-dark); color: #e0e0e0; font-size: 19px; line-height: 1.6; }
        
        /* LOADING */
        #loading-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 9999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .spinner { font-size: 4em; color: var(--gold); animation: spin 2s linear infinite; margin-bottom: 20px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* LAYOUT */
        .container { max-width: 900px; margin: 0 auto; padding: 20px 20px 100px 20px; }
        
        .nav-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .btn-back { cursor: pointer; color: #666; text-transform: uppercase; font-size: 0.8em; letter-spacing: 2px; border-bottom: 1px solid transparent; transition:0.3s; }
        .btn-back:hover { color: var(--gold); border-color: var(--gold); }
        .btn-print { background: var(--gold); color: #000; border: none; padding: 8px 15px; border-radius: 4px; font-family: 'Cinzel'; cursor: pointer; font-weight: bold; }

        .header-title { font-family: 'Cinzel'; color: var(--gold); text-align: center; font-size: 2.5em; margin-top: 20px; text-shadow: 0 0 20px rgba(212,175,55,0.3); }
        .user-details { text-align: center; color: #888; margin-bottom: 40px; text-transform: uppercase; letter-spacing: 1px; }

        /* BLOCO DE EXPLICAÇÃO (INTRO) */
        .intro-box {
            background: rgba(20, 20, 20, 0.6); border: 1px solid #333; padding: 30px; 
            border-radius: 8px; margin-bottom: 50px; text-align: justify; border-left: 3px solid var(--red);
        }
        .intro-title { color: var(--gold); font-family: 'Cinzel'; font-size: 1.2em; margin-bottom: 15px; text-transform: uppercase; }
        .intro-text { font-size: 1em; color: #ccc; line-height: 1.7; }

        /* CARTÃO DO RESULTADO */
        .china-card {
            background: radial-gradient(circle at center, #1a1a1a 0%, #000 100%);
            border: 1px solid var(--gold); border-radius: 8px; padding: 50px 30px; margin-top: 30px;
            text-align: center; position: relative; overflow: hidden;
            box-shadow: 0 0 40px rgba(138, 28, 28, 0.15);
        }
        .china-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 5px; background: var(--red); }

        .animal-icon { font-size: 6em; color: var(--gold); margin-bottom: 20px; text-shadow: 0 0 20px rgba(212,175,55,0.3); }
        .animal-title { font-family: 'Cinzel'; font-size: 3.5em; color: #fff; margin: 0; text-transform: uppercase; line-height: 1; }
        .element-badge { 
            background: var(--red); color: #fff; padding: 5px 25px; border-radius: 30px; 
            display: inline-block; margin-top: 15px; font-family: 'Cinzel'; font-size: 1.1em; letter-spacing: 2px;
        }

        /* REPORT DETALHADO */
        .report-section { margin-top: 50px; display: grid; grid-template-columns: 1fr; gap: 30px; }
        .report-block { background: rgba(255,255,255,0.03); padding: 30px; border-radius: 4px; border: 1px solid #222; }
        .block-head { color: var(--gold); font-family: 'Cinzel'; font-size: 1.4em; margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        .block-text { color: #ccc; text-align: justify; font-size: 1.05em; }
        .highlight { color: #fff; font-weight: bold; }

        @media print { .btn-back, .btn-print, .intro-box { display: none; } body { background: #fff; color: #000; } .china-card, .report-block { border: 1px solid #000; color: #000; background: #fff; } }
    </style>
</head>
<body>

<div id="loading-screen">
    <i class="fas fa-compass spinner"></i>
    <p style="color:#666; font-family:'Cinzel'; margin-top:15px; letter-spacing:2px;">Calculando Ciclos Lunares...</p>
</div>

<div class="container">
    <div class="nav-bar">
        <div onclick="window.location.href='dashboard-premium.html'" class="btn-back">← Voltar ao Hub</div>
        <button onclick="window.print()" class="btn-print"><i class="fas fa-print"></i> Imprimir</button>
    </div>

    <h1 class="header-title">ZODÍACO CHINÊS (SHENG XIAO)</h1>
    <div class="user-details" id="user-info">...</div>

    <div class="intro-box">
        <div class="intro-title">Como Funciona este Sistema?</div>
        <div class="intro-text">
            Diferente da astrologia ocidental, baseada nos meses solares, o Zodíaco Chinês baseia-se em um ciclo lunar de 12 anos. Cada ano é regido por um animal arquétipo.
            <br><br>
            Porém, o animal é apenas metade da história. Existe também um ciclo de 10 anos dos <strong>5 Elementos</strong> (Metal, Água, Madeira, Fogo, Terra). 
            A combinação do seu Animal com seu Elemento de nascimento cria sua identidade única entre 60 possibilidades. Abaixo, revelamos a sua combinação exata.
        </div>
    </div>

    <div class="china-card">
        <div class="animal-icon" id="res-icon"></div>
        <h2 class="animal-title" id="res-animal">...</h2>
        <div class="element-badge" id="res-element">...</div>
    </div>

    <div class="report-section" id="report-content">
        </div>
</div>

<script>
    // --- 1. FAILSAFE ---
    setTimeout(() => { document.getElementById('loading-screen').style.display = 'none'; }, 3000);

    // --- 2. DADOS DENSOS ---
    const ANIMAIS_DATA = {
        "Rato": {
            icon: "fas fa-mouse",
            arq: "O Estrategista",
            desc: "Inteligente, engenhoso e versátil. O Rato é o primeiro signo do ciclo, representando inícios e sobrevivência. Você possui uma mente afiada capaz de ver oportunidades onde ninguém mais vê. Seu charme social esconde um observador calculista e prudente.",
            work: "Excelente em negócios, finanças e qualquer campo que exija adaptação rápida. Você trabalha melhor quando tem autonomia.",
            love: "Você é dedicado e apaixonado, mas pode ser possessivo. Busca parceiros que ofereçam segurança e lealdade."
        },
        "Boi": {
            icon: "fas fa-bullhorn", // Representação visual
            arq: "O Realizador Silencioso",
            desc: "Diligente, dependente e forte. O Boi representa a prosperidade alcançada através do trabalho duro. Você não gosta de atalhos. Sua palavra é uma promessa inquebrável. Embora possa parecer teimoso, é apenas sua firmeza de caráter em ação.",
            work: "Metódico e lógico. Você constrói impérios tijolo por tijolo. É um líder respeitado pela ética, não pelo medo.",
            love: "Você demora para se abrir, mas quando ama, é para a vida toda. Busca estabilidade acima de aventura."
        },
        "Tigre": {
            icon: "fas fa-cat",
            arq: "O Rebelde Corajoso",
            desc: "Corajoso, confiante e magnético. O Tigre nasceu para liderar e desafiar o status quo. Você é movido pela paixão e pelo instinto. Sua natureza é imprevisível e nobre; você protege ferozmente aqueles que ama, mas não tolera desrespeito.",
            work: "Precisa de desafios. Ambientes monótonos matam seu espírito. Você brilha em posições de comando ou empreendedorismo arriscado.",
            love: "Intenso e dominador. Relacionamentos com você são uma aventura emocionante, cheia de altos e baixos."
        },
        "Coelho": {
            icon: "fas fa-paw",
            arq: "O Diplomata Refinado",
            desc: "Tranquilo, elegante e responsável. O Coelho é o símbolo da longevidade e da sorte. Você detesta conflitos e tem um talento natural para encontrar soluções pacíficas. Sua sensibilidade artística e bom gosto são notáveis. Por trás da gentileza, há uma mente astuta.",
            work: "Excelente em diplomacia, artes, design e direito. Você avança através de conexões sociais e tato.",
            love: "Romântico e sensível. Você precisa de um parceiro que entenda sua necessidade de harmonia e evite agressividade."
        },
        "Dragão": {
            icon: "fas fa-dragon",
            arq: "O Visionário Poderoso",
            desc: "Poderoso, nobre e sortudo. O Dragão é o único animal mítico do zodíaco, representando poder celestial. Você possui um carisma natural e uma autoconfiança inabalável. Nasceu para deixar um legado e inspirar os outros com sua visão grandiosa.",
            work: "Visionário. Você não lida bem com detalhes rotineiros; precisa de uma equipe para executar suas grandes ideias.",
            love: "Você busca alguém que admire sua força, mas que não compita com ela. Precisa de espaço para voar."
        },
        "Serpente": {
            icon: "fas fa-staff-snake",
            arq: "O Filósofo Enigmático",
            desc: "Enigmática, inteligente e sábia. A Serpente é o arquétipo do mistério e da intuição profunda. Você não fala muito, mas quando fala, todos ouvem. Possui um sexto sentido apurado para mentiras e situações vantajosas. Sua mente é filosófica e calculista.",
            work: "Pesquisador, cientista ou estrategista. Você resolve problemas complexos em silêncio e com precisão.",
            love: "Sedutor e possessivo. Você escolhe parceiros com muito critério e exige lealdade absoluta."
        },
        "Cavalo": {
            icon: "fas fa-horse",
            arq: "O Espírito Livre",
            desc: "Animado, ativo e enérgico. O Cavalo ama a liberdade acima de tudo. Você é a alma da festa, otimista e comunicativo. Sua mente é rápida, mas pode ser impaciente. Você galopa pela vida buscando novas experiências e detesta se sentir amarrado.",
            work: "Vendas, comunicação e viagens. Você precisa de movimento e interação social constante.",
            love: "Apaixona-se rápido e intensamente, mas pode perder o interesse se a rotina se instalar. Precisa de um parceiro independente."
        },
        "Cabra": {
            icon: "fas fa-bacon", // Placeholder approx
            arq: "O Artista Compassivo",
            desc: "Calma, gentil e simpática. A Cabra é o signo da arte e da beleza. Você é sonhador e tem um coração enorme, sempre preocupado com o bem-estar alheio. Evita confrontos diretos e prefere persuadir pela gentileza. Sua criatividade é sua maior arma.",
            work: "Artes, cura e assistência social. Você precisa de um ambiente harmonioso e sem pressão excessiva.",
            love: "Carente e carinhoso. Você precisa de proteção e estabilidade emocional em um relacionamento."
        },
        "Macaco": {
            icon: "fas fa-atom", // Intellect
            arq: "O Inovador Ágil",
            desc: "Afiado, inteligente e curioso. O Macaco é o solucionador de problemas do zodíaco. Não há desafio que sua mente ágil não possa desvendar. Você é brincalhão, às vezes travesso, e possui uma capacidade de aprendizado acelerada.",
            work: "Inovação, tecnologia e engenharia. Você prospera em ambientes caóticos onde precisa improvisar.",
            love: "Divertido e estimulante. Você precisa de um parceiro intelectualmente desafiador para não ficar entediado."
        },
        "Galo": {
            icon: "fas fa-crow",
            arq: "O Perfeccionista",
            desc: "Observador, trabalhador e corajoso. O Galo é o signo da franqueza e da organização. Você gosta de estar no comando e de aparecer, sempre impecável. Sua atenção aos detalhes é lendária, embora possa ser crítico demais consigo mesmo e com os outros.",
            work: "Administração, finanças e moda. Você organiza o caos e garante que tudo esteja perfeito.",
            love: "Leal e protetor. Você gosta de cuidar do parceiro, mas exige que ele atenda aos seus altos padrões."
        },
        "Cão": {
            icon: "fas fa-dog",
            arq: "O Guardião Leal",
            desc: "Leal, honesto e prudente. O Cão é o signo da justiça. Você tem um radar moral inabalável e luta pelos oprimidos. É o melhor amigo que alguém pode ter, sempre alerta e fiel. Tende a se preocupar demais, mas isso vem do seu desejo de proteger.",
            work: "Justiça, segurança e serviço social. Você trabalha por uma causa, não apenas por dinheiro.",
            love: "Fiel até o fim. Você demora para confiar, mas uma vez que entrega seu coração, é para sempre."
        },
        "Porco": {
            icon: "fas fa-piggy-bank",
            arq: "O Filantropo Hedonista",
            desc: "Compassivo, generoso e diligente. O Porco fecha o ciclo com sabedoria e prazer. Você ama as coisas boas da vida e gosta de compartilhar. É ingênuo por escolha, preferindo ver o lado bom das pessoas. Sua força interior é imensa, suportando fardos sem reclamar.",
            work: "Qualquer área onde possa ajudar ou entreter. Você trabalha duro para poder desfrutar depois.",
            love: "Afetuoso e sensual. Você se entrega totalmente e busca uma conexão profunda e confortável."
        }
    };

    const ELEMENTOS_DATA = {
        "Metal": "O Metal traz rigidez, determinação e ambição. Torna você mais focado no sucesso, independente e às vezes inflexível. Sua mente é cortante como uma espada.",
        "Água": "A Água traz fluidez, intuição e diplomacia. Torna você mais adaptável, comunicativo e capaz de influenciar os outros sutilmente, infiltrando-se como a maré.",
        "Madeira": "A Madeira traz crescimento, criatividade e cooperação. Torna você mais ético, expansivo e interessado no progresso comunitário. Você busca criar raízes.",
        "Fogo": "O Fogo traz paixão, dinamismo e liderança. Torna você mais impulsivo, carismático e aventureiro. Você queima com um desejo de ação e reconhecimento.",
        "Terra": "A Terra traz estabilidade, praticidade e cautela. Torna você mais confiável, pé no chão e focado em resultados tangíveis e segurança a longo prazo."
    };

    // --- 3. LÓGICA DE CÁLCULO ---
    const ANIMAIS_LIST = ["Macaco","Galo","Cão","Porco","Rato","Boi","Tigre","Coelho","Dragão","Serpente","Cavalo","Cabra"];
    const ELEMENTOS_LIST = ["Metal","Metal","Água","Água","Madeira","Madeira","Fogo","Fogo","Terra","Terra"];

    function calcularChines(ano) {
        // Animal: Ciclo de 12 (Resto da divisão por 12)
        const animalNome = ANIMAIS_LIST[ano % 12];
        
        // Elemento: Último dígito do ano (0-9)
        const elementoNome = ELEMENTOS_LIST[ano % 10];
        
        return { animal: animalNome, elemento: elementoNome };
    }

    // --- 4. RENDERIZAÇÃO ---
    function renderizar(ano) {
        const res = calcularChines(ano);
        const dataAnimal = ANIMAIS_DATA[res.animal];
        const textoElemento = ELEMENTOS_DATA[res.elemento];

        // Preenche Cartão Principal
        document.getElementById('res-icon').innerHTML = `<i class="${dataAnimal.icon}"></i>`;
        document.getElementById('res-animal').innerText = res.animal;
        document.getElementById('res-element').innerText = `${res.elemento} (Yin/Yang)`;

        // Gera Relatório Denso
        const area = document.getElementById('report-content');
        area.innerHTML = `
            <div class="report-block">
                <div class="block-head">ARQUÉTIPO: ${dataAnimal.arq.toUpperCase()}</div>
                <div class="block-text">
                    ${dataAnimal.desc}
                </div>
            </div>

            <div class="report-block">
                <div class="block-head">A INFLUÊNCIA DO ELEMENTO ${res.elemento.toUpperCase()}</div>
                <div class="block-text">
                    Você não é apenas um ${res.animal}, você é um <strong>${res.animal} de ${res.elemento}</strong>. 
                    <br><br>
                    ${textoElemento}
                    <br><br>
                    Essa combinação molda sua personalidade de forma única, diferenciando você de pessoas do mesmo signo nascidas em anos diferentes.
                </div>
            </div>

            <div class="report-block">
                <div class="block-head">CARREIRA E DINHEIRO</div>
                <div class="block-text">
                    ${dataAnimal.work}
                </div>
            </div>

            <div class="report-block">
                <div class="block-head">AMOR E RELACIONAMENTOS</div>
                <div class="block-text">
                    ${dataAnimal.love}
                </div>
            </div>
        `;

        document.getElementById('loading-screen').style.display = 'none';
    }

    // --- 5. AUTH ---
    const firebaseConfig = { apiKey: "AIzaSyDMeLgPB2wroI-papk-T9R_mbCcj3MC2TE", authDomain: "portal-mistico-6532b.firebaseapp.com", projectId: "portal-mistico-6532b", storageBucket: "portal-mistico-6532b.firebasestorage.app", messagingSenderId: "925159229004", appId: "1:925159229004:web:5d9dc758474789085016e9" };
    try { firebase.initializeApp(firebaseConfig); } catch(e) {}
    const auth = firebase.auth();
    const db = firebase.firestore();

    auth.onAuthStateChanged(user => {
        if(user){
            db.collection("usuarios").doc(user.uid).get().then(doc => {
                const d = doc.exists ? doc.data() : {};
                const nome = d.nome || "Iniciado";
                // Compatibilidade de dados
                const dataStr = d.dataNascimento || d.nascimento || "2000-01-01";
                const ano = parseInt(dataStr.split('-')[0]);
                
                document.getElementById('user-info').innerText = `${nome} • Nascido em ${ano}`;
                renderizar(ano);
            }).catch(e => {
                renderizar(2000); // Fallback Dragão de Metal
            });
        } else {
            window.location.href = 'index.html';
        }
    });
</script>
</body>
</html>